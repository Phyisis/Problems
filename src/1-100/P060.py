import repackage; repackage.up()
from helpers import analytics,primes
analytics.monitor()

limit = int(1e8)
primesList = primes.primes(limit)
print(len(primesList),"primes generated in",analytics.lap())
primesHash = set(primesList)

def pconcat(a,b):
    if int(str(a)+str(b)) in primesHash and int(str(b)+str(a)) in primesHash:
        return True
    return False

def canAdd(s,p):
    for q in s:
        if not pconcat(p,q):
            return False
    return True

def main():
    sets = []
    for p in primesList:
        for s in sets:
            if canAdd(s,p):
                newSet = tuple(list(s)+[p])
                sets.append(newSet)
                if len(newSet) == 6:
                    return sum(newSet), newSet
        sets.append((p,))
    return False

print(main(), analytics.lap(), analytics.maxMem())

"""
{(193, 283), (137, 239), (461, 479), (13, 2689), (59, 971), (67, 157), (239, 263), (61, 751), (179, 743), (101, 149), (47, 8171), 
(337, 691), (149, 491), (19, 1693), (7, 937), (163, 367), (541, 727), (419, 701), (109, 661), (29, 9857), (229, 433), (29, 179), (347, 983), (59, 9857), (419, 449), (397, 547), (107, 857), (181, 397), (73, 571), (719, 947), (277, 751), (7, 109), (347, 443), (61, 5449), (23, 89), (277, 499), (53, 6353), (3, 8747), (37, 1951), (73, 9601), (389, 947), (509, 863), (19, 181), (17, 257), (17, 7841), (29, 
761), (11, 743), (457, 829), (79, 2689), (47, 521), (97, 787), (109, 883), (263, 941), (317, 503), (79, 631), (67, 5581), (131, 641), 
(809, 821), (47, 269), (53, 1481), (541, 661), (3, 613), (229, 547), (877, 997), (163, 193), (181, 619), (281, 557), (607, 619), (23, 
4211), (503, 647), (109, 199), (43, 9787), (197, 311), (311, 827), (31, 1447), (443, 983), (3, 73), (79, 5581), (73, 9787), (719, 773), (409, 733), (307, 577), (53, 401), (509, 797), (157, 229), (31, 907), (67, 601), (3, 701), (727, 997), (3, 557), (17, 83), (199, 877), (421, 661), (97, 829), (163, 811), (37, 5281), (541, 991), (641, 929), (167, 521), (659, 983), (3, 449), (487, 727), (31, 4159), (641, 821), (643, 751), (691, 907), (911, 947), (89, 5039), (113, 149), (167, 269), (109, 673), (523, 541), (3, 17), (349, 919), (197, 641), (283, 601), (71, 947), (401, 593), (739, 853), (11, 9419), (499, 691), (379, 811), (3, 7), (89, 4211), (103, 997), (443, 953), (31, 1237), (3, 7591), (311, 653), (71, 263), (461, 677), (83, 911), (647, 953), (463, 643), (293, 311), (193, 373), (461, 569), (173, 431), (11, 863), (163, 997), (307, 367), (239, 461), (13, 829), (101, 383), (223, 229), (491, 983), (577, 757), (53, 2069), (269, 461), (53, 5861), (199, 811), (577, 613), (83, 227), (13, 577), (131, 941), (257, 263), (641, 863), (727, 823), (67, 139), (661, 877), (131, 797), (167, 491), (439, 541), (113, 227), (3, 733), (7, 883), (281, 857), (37, 991), (337, 349), (23, 827), (503, 911), (37, 2689), 
(41, 593), (379, 997), (587, 617), (241, 883), (739, 751), (811, 919), (7, 487), (227, 719), (47, 9419), (359, 911), (137, 947), (3, 229), (23, 9857), (193, 883), (547, 823), (139, 619), (79, 5449), (37, 199), (29, 5039), (17, 491), (67, 757), (479, 701), (83, 701), (11, 941), (59, 5039), (17, 383), (19, 163), (17, 239), (883, 991), (83, 449), (7, 8941), (167, 677), (3, 3049), (3, 2411), (421, 709), (29, 599), (491, 773), (269, 431), (37, 8941), (13, 367), (691, 919), (127, 733), (29, 167), (23, 761), (7, 673), (827, 857), (131, 479), (233, 347), (73, 2689), (59, 167), (811, 997), (181, 421), (23, 509), (233, 239), (3, 271), (47, 1481), (139, 661), (359, 701), (89, 431), (569, 659), (37, 277), (211, 313), (241, 421), (307, 631), (293, 467), (79, 1447), (241, 313), (11, 8747), (17, 2411), (389, 971), (307, 523), (53, 2333), (137, 197), (67, 547), (151, 769), (239, 509), (19, 97), (269, 617), (29, 6563), (97, 919), (593, 863), (59, 929), (223, 277), (67, 9829), (373, 859), (439, 661), (421, 643), (101, 107), (163, 613), (113, 383), (179, 593), (263, 821), (47, 293), (97, 379), (317, 419), (181, 787), (337, 397), (23, 8423), (433, 859), (47, 149), (79, 367), (83, 5441), (191, 953), (29, 137), (181, 499), (433, 571), (757, 811), (23, 8171), (37, 607), (127, 271), (29, 9419), (37, 463), (211, 499), (499, 673), (7, 9601), (347, 401), (193, 751), (73, 277), (23, 47), (19, 571), (479, 821), (37, 67), (617, 647), (11, 953), (251, 971), (479, 569), (389, 761), (389, 797), (83, 2411), (19, 31), (11, 701), (373, 937), (19, 9601), (457, 643), (13, 523), (251, 431), (271, 409), (421, 433), (131, 743), (3, 823), (151, 163), (7, 829), (229, 613), (23, 773), (179, 383), (521, 641), (31, 139), (127, 601), (317, 353), (89, 983), (13, 127), (263, 647), (7, 541), (71, 971), (29, 71), (41, 719), (383, 419), (13, 5581), (43, 499), (79, 193), (233, 251), (7, 433), (73, 607), (191, 599), (73, 643), (71, 719), (277, 787), (19, 937), (331, 349), (61, 1693), (89, 443), (139, 709), (3, 31), (547, 769), (311, 821), (43, 103), (311, 677), (37, 9679), (409, 691), (37, 5923), (193, 541), (547, 661), (223, 829), (137, 353), (3, 947), (463, 
523), (193, 433), (13, 997), (167, 911), (251, 761), (509, 647), (113, 647), (13, 709), (97, 967), (17, 2027), (439, 853), (37, 1447), (109, 919), (29, 401), (3, 2069), (31, 181), (149, 173), (11, 239), (29, 7841), (179, 317), (3, 11), (23, 743), (419, 563), (13, 61), (379, 877), (89, 809), (587, 677), (773, 953), (449, 563), (769, 919), (263, 293), (467, 617), (7, 4159), (23, 311), (197, 347), (89, 521), (139, 787), (3, 109), (43, 5923), (563, 971), (37, 4159), (19, 727), (41, 257), (349, 373), (821, 857), (191, 281), (37, 79), (71, 257), (61, 3181), (71, 7841), (613, 661), (311, 359), (733, 991), (17, 2069), (7, 1237), (151, 607), (53, 2027), (103, 307), (233, 911), (73, 1447), (101, 197), (881, 983), (439, 787), (373, 661), (37, 1237), (491, 653), (47, 2333), (149, 251), (419, 929), (31, 9829), (523, 577), (199, 373), (13, 103), (23, 6563), (31, 151), (163, 307), (809, 827), (67, 3637), (331, 937), (41, 8423), (79, 6091), (23, 677), (29, 5861), (31, 7591), (229, 373), (61, 151), (197, 569), (71, 8423), (769, 997), (109, 313), (281, 419), (3, 331), (431, 857), (79, 5659), (43, 223), (181, 193), (17, 881), (71, 443), (227, 281), (239, 929), (443, 701), (613, 883), (599, 719), (17, 449), (151, 937), (239, 641), (971, 977), (3, 5281), (577, 937), (43, 7159), (317, 983), (743, 947), (11, 503), (151, 397), (73, 7159), (269, 389), (233, 881), (199, 739), (353, 797), (661, 769), (11, 251), (383, 797), (709, 967), (433, 883), (761, 977), (571, 853), (191, 
977), (709, 823), (397, 673), (739, 967), (3, 373), (7, 523), (877, 937), (89, 821), (19, 991), (139, 907), (241, 811), (109, 139), (839, 887), (569, 797), (7, 127), (211, 271), (307, 733), (223, 919), (137, 587), (71, 233), (479, 881), (139, 367), (89, 137), (463, 613), (241, 271), (751, 787), (563, 587), (157, 277), (61, 3049), (613, 673), (479, 593), (101, 641), (23, 1481), (137, 191), (53, 197), (317, 773), (743, 881), (337, 607), (199, 673), (281, 971), (29, 347), (367, 751), (521, 809), (79, 613), (7, 853), (29, 383), (809, 
983), (47, 251), (3, 739), (353, 443), (349, 967), (809, 839), (449, 941), (41, 887), (97, 373), (19, 8941), (521, 557), (653, 941), (71, 887), (127, 373), (283, 397), (89, 6353), (7, 6091), (29, 5441), (43, 271), (241, 601), (823, 877), (83, 5039), (37, 313), (211, 349), (7, 61), (191, 227), (7, 5659), (193, 601), (101, 719), (79, 3181), (53, 419), (173, 191), (83, 563), (3, 719), (733, 829), (29, 
569), (199, 751), (23, 8747), (593, 647), (13, 337), (3, 9857), (487, 601), (113, 131), (11, 2069), (197, 947), (11, 5861), (113, 167), (3, 673), (331, 883), (47, 2027), (131, 449), (281, 653), (89, 977), (433, 787), (331, 739), (199, 211), (419, 443), (281, 509), (313, 727), (71, 6563), (71, 821), (31, 3637), (431, 947), (467, 641), (241, 823), (503, 563), (431, 983), (127, 163), (181, 283), (43, 6091), (211, 571), (79, 7591), (569, 773), (17, 971), (61, 3637), (569, 809), (137, 743), (71, 389), (461, 983), (73, 6091), (211, 283), (359, 563), (3, 3637), (89, 293), (379, 397), (613, 829), (137, 491), (7, 1693), (73, 5659), (17, 431), (631, 739), (53, 353), (47, 
947), (37, 5449), (157, 181), (31, 859), (593, 977), (3, 617), (677, 827), (71, 9419), (151, 631), (149, 563), (229, 937), (643, 991), (641, 881), (397, 907), (41, 863), (181, 757), (3, 607), (7, 757), (13, 19), (31, 9601), (97, 241), (3, 499), (73, 823), (877, 883), 
(127, 241), (449, 557), (227, 593), (277, 859), (569, 887), (3, 67), (719, 911), (173, 743), (479, 971), (139, 457), (193, 577), (19, 577), (443, 761), (19, 433), (43, 1693), (89, 5861), (3, 5449), (251, 941), (173, 347), (83, 719), (19, 9679), (7, 3181), (457, 757), 
(439, 601), (37, 3181), (487, 757), (167, 443), (233, 617), (383, 821), (163, 409), (3, 191), (809, 929), (313, 991), (19, 1447), (13, 241), (263, 761), (419, 599), (31, 9679), (3, 541), (7, 691), (127, 607), (31, 1951), (467, 941), (29, 2027), (43, 613), (11, 23), (7, 547), (73, 757), (283, 487), (211, 727), (61, 1951), (139, 967), (23, 2333), (67, 8941), (241, 691), (7, 9829), (823, 967), (3, 5923), (191, 461), (839, 911), (241, 727), (349, 409), (157, 733), (617, 983), (3, 37), (53, 653), (149, 971), (269, 887), (137, 359), (23, 5441), (631, 751), (223, 547), (113, 761), (733, 883), (19, 79), (163, 883), (337, 919), (239, 347), (53, 7841), (151, 499), (53, 113), (233, 983), (257, 293), (179, 719), (659, 947), (47, 419), (11, 353), (47, 4211), (401, 809), (863, 983), (41, 911), (71, 8747), (19, 7159), (691, 727), (61, 331), (43, 691), (19, 1237), (353, 359), (449, 821), (97, 9787), (79, 241), (757, 829), (263, 443), (3, 4159), (97, 1951), (503, 653), (929, 941), (467, 587), (331, 577), (73, 547), (431, 929), (821, 971), (7, 229), (211, 373), (31, 5281), 
(547, 853), (41, 227), (821, 827), (53, 8423), (191, 251), (751, 997), (73, 9829), (547, 709), (359, 509), (509, 947), (67, 751), (113, 983), (277, 331), (73, 7591), (3, 7159), (83, 8171), (29, 881), (83, 443), (103, 421), (3, 1237), (79, 967), (223, 337), (881, 953), (151, 433), (383, 941), (439, 613), (487, 769), (269, 317), (37, 3049), (109, 859), (401, 887), (197, 971), (13, 9787), (131, 617), (229, 631), (61, 409), (3, 59), (607, 991), (401, 743), (331, 907), (521, 659), (199, 379), (367, 457), (859, 919), (811, 991), (283, 463), (929, 983), (59, 197), (227, 827), (127, 331), (349, 709), (673, 769), (241, 739), (193, 811), (599, 941), (181, 199), (139, 547), (547, 787), (7, 19), (137, 659), (547, 643), (619, 811), (409, 709), (463, 829), (617, 887), (97, 5281), (83, 773), (31, 991), (3, 929), (173, 293), (919, 937), (3, 6563), (53, 269), (167, 641), (43, 3049), (251, 491), (67, 5923), (661, 883), (251, 347), (131, 839), (113, 233), (491, 593), (13, 331), (61, 487), (281, 719), (3, 137), (59, 419), (79, 397), (541, 571), (11, 113), (59, 4211), (283, 541), (601, 823), (97, 157), (929, 953), (79, 9679), (19, 997), (41, 2333), (379, 751), (293, 827), (349, 499), (127, 157), (311, 881), 
(19, 709), (7, 97), (563, 809), (239, 977), (107, 449), (173, 659), (547, 577), (157, 571), (89, 107), (461, 653), (787, 823), (61, 8941), (67, 619), (17, 389), (149, 953), (647, 821), (479, 599), (101, 467), (11, 839), (11, 8423), (3, 6353), (71, 5441), (179, 953), (83, 311), (101, 359), (97, 883), (19, 5659), (3, 467), (11, 587), (373, 823), (457, 673), (11, 8171), (421, 607), (3, 359), (7, 823), 
(281, 797), (607, 967), (37, 967), (367, 613), (181, 751), (229, 499), (179, 269), (691, 709), (349, 829), (181, 607), (313, 619), (41, 2411), (7, 283), (3, 1481), (653, 659), (97, 5581), (43, 97), (293, 617), (359, 599), (71, 317), (239, 947), (17, 6353), (431, 479)}
"""